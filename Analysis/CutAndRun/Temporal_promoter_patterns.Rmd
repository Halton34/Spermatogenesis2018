---
title: "Temporal promoter patterns"
author: "Nils Eling"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_depth: 2
knit: (function(inputFile, encoding) { rmarkdown::render(inputFile, 
        encoding = encoding, output_file = '/Users/nils/Dropbox (Cambridge University)/SST_spermatocytes/Analysis/CnR/Temporal_promoter_patterns.html') })
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This script performs analysis of temporal changes regarding the enrichemnt of histone marks at promoters.

## H3K4me3

```{r}
# Read in files
files <- list.files("../../../../Dropbox (Cambridge University)/SST_spermatocytes/Analysis/CnR/promoters/H3K4me3/", full.names = TRUE)
names <- list.files("../../../../Dropbox (Cambridge University)/SST_spermatocytes/Analysis/CnR/promoters/H3K4me3/", full.names = FALSE)

all.data <- lapply(as.list(files), function(n){
  read.table(n, sep = " ", header = TRUE)
})
all.data <- do.call("cbind", all.data)

# Create metadata file
meta <- data.frame(library = sapply(names, function(n){unlist(strsplit(n, "_"))[1]}),
                   mark = sapply(names, function(n){unlist(strsplit(n, "_"))[2]}),
                   celltype = sapply(names, function(n){unlist(strsplit(n, "_"))[3]}),
                   Pday = sub("JP", "", sapply(names, function(n){unlist(strsplit(n, "_"))[6]})))

```